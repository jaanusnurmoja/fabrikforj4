/*! Fabrik */
define(["jquery","fab/loader","fab/requestqueue"],function(e,t,o){var i=e(document);document.addEvent("click:relay(.popover button.close)",function(t,o){var i="#"+o.get("data-popover"),n=document.getElement(i);e(i).popover("hide"),"null"!==typeOf(n)&&"input"===n.get("tag")&&(n.checked=!1)});var n={events:{}};function a(){let e=document.getElementById("filter_form"),t=document.getElementById("filter_group"),o=e.value;Array.from(t.getElementsByTagName("optgroup")).forEach(t=>{t.style.display=t.label===e.options[e.selectedIndex].text||""===o?"block":"none"})}return document.body.classList.contains("com_fabrik")&&(document.body.classList.contains("view-elements")||document.body.classList.contains("view-groups"))&&window.innerWidth>=768&&document.querySelectorAll(".js-stools-container-filters").forEach(e=>{e.classList.add("js-stools-container-filters-visible")}),window.location.href.includes("view=elements")&&(document.getElementById("filter_form").addEventListener("change",a),a()),n.bootstrapVersion=function(t){var o,i=[t||"modal","tooltip"],n=i.length;for(o=0;o<n;++o){var a=e.fn[i[o]];if(a){if(a.VERSION)return a.VERSION.match(/(\d+)\./)[0].toInt();if(a.Constructor&&a.Constructor.VERSION)return a.Constructor.VERSION.match(/(\d+)\./)[0].toInt()}}return 2},n.Windows={},n.loader=new t,n.blocks={},n.periodicals={},n.addBlock=function(e,t){n.blocks[e]=t,n.fireEvent("fabrik.block.added",[t,e])},n.getBlock=function(e,t,o){return(o=!!o&&o)&&(n.periodicals[e]=n._getBlock.periodical(500,this,[e,t,o])),n._getBlock(e,t,o)},n._getBlock=function(e,t,o){var i;if(t=!!t&&t,void 0!==n.blocks[e])i=e;else{if(t)return!1;var a=Object.keys(n.blocks),l=a.searchFor(e);if(-1===l)return!1;i=a[l]}return o&&(clearInterval(n.periodicals[e]),o(n.blocks[i])),n.blocks[i]},i.on("click",".fabrik_delete a, .fabrik_action a.delete, .btn.delete",function(e){!e.rightClick&&n.watchDelete(e,this)}),i.on("click",".fabrik_edit a, a.fabrik_edit",function(e){!e.rightClick&&n.watchEdit(e,this)}),i.on("click",".fabrik_view a, a.fabrik_view",function(e){!e.rightClick&&n.watchView(e,this)}),document.addEvent("click:relay(*[data-fabrik-view])",function(e,t){if(!e.rightClick){e.preventDefault(),o=(i="a"===e.target.get("tag")?e.target:"null"!==typeOf(e.target.getElement("a"))?e.target.getElement("a"):e.target.getParent("a")).get("href"),o+=o.contains("?")?"&tmpl=component&ajax=1":"?tmpl=component&ajax=1",o+="&format=partial",$H(n.Windows).each(function(e,t){e.close()}),(a=i.get("title"))||(a=Joomla.JText._("COM_FABRIK_VIEW"));var o,i,a,l={id:"view."+o,title:a,loadMethod:"xhr",contentURL:o};n.getWindow(l)}}),n.removeEvent=function(e,t){if(n.events[e]){var o=n.events[e].indexOf(t);-1!==o&&delete n.events[e][o]}},n.addEvent=n.on=function(e,t){n.events[e]||(n.events[e]=[]),n.events[e].contains(t)||n.events[e].push(t)},n.addEvents=function(e){var t;for(t in e)e.hasOwnProperty(t)&&n.addEvent(t,e[t]);return this},n.fireEvent=n.trigger=function(e,t,o){var i=n.events;return this.eventResults=[],i&&i[e]&&(t=Array.mfrom(t),i[e].each(function(e){o?this.eventResults.push(e.delay(o,this,t)):this.eventResults.push(e.apply(this,t))},this)),this},n.requestQueue=new o,n.cbQueue={google:[]},n.loadGoogleMap=function(e,t,o){var i=("https:"===document.location.protocol?"https:":"http:")+"//maps.googleapis.com/maps/api/js?libraries=places,visualization&callback=Fabrik.mapCb";if(!1!==e&&(i+="&key="+e),""!==o&&(i+="&language="+o),0===Array.mfrom(document.scripts).filter(function(e){return e.src===i}).length){var a=document.createElement("script");a.type="text/javascript",a.src=i,document.body.appendChild(a),n.cbQueue.google.push(t)}else n.googleMap?window[t]():n.cbQueue.google.push(t)},n.mapCb=function(){var e,t;for(t=0,n.googleMap=!0;t<n.cbQueue.google.length;t++)"function"===typeOf(e=n.cbQueue.google[t])?e():window[e]();n.cbQueue.google=[]},n.watchDelete=function(e,t){var o,i,a;if((a=e.target.getParent(".fabrik_row"))||(a=n.activeRow),a){var l=a.getElement("input[type=checkbox][name*=id]");"null"!==typeOf(l)&&(l.checked=!0),i=(i=a.id.split("_")).splice(0,i.length-2).join("_"),o=n.blocks[i]}else if("null"!==typeOf(i=e.target.getParent(".fabrikList")))i=i.id,o=n.blocks[i];else{var r=t.getParent(".floating-tip-wrapper");i=r?r.retrieve("list").id:t.get("data-listRef"),void 0===(o=n.blocks[i])||"floating"!==o.options.actionMethod||this.bootstrapped||o.form.getElements("input[type=checkbox][name*=id], input[type=checkbox][name=checkAll]").each(function(e){e.checked=!0})}o.submit("list.delete")||e.preventDefault()},n.watchEdit=function(e,t){n.openSingleView("form",e,t)},n.watchView=function(e,t){n.openSingleView("details",e,t)},n.openSingleView=function(t,o,i){var a,l,r,s,c,p,f,d=e(i).data("list"),u=n.blocks[d];if(1===e(i).data("isajax")){if(u){if(!u.options.ajax_links||!(p=u.getActiveRow(o))||0===p.length)return;u.setActive(p),c=p.prop("id").split("_").pop()}else c=e(i).data("rowid");o.preventDefault(),a=(r="A"===e(o.target).prop("tagName")?e(o.target):e(o.target).find("a").length>0?e(o.target).find("a"):e(o.target).closest("a")).prop("href"),1!==e(i).data("iscustom")&&(a+=a.contains("?")?"&tmpl=component&ajax=1":"?tmpl=component&ajax=1",a+="&format=partial"),s=r.prop("title"),void 0===(l=r.data("loadmethod"))&&(l="xhr"),e.each(n.Windows,function(e,t){t.close()}),f={modalId:"ajax_links",id:d+"."+c,title:s,loadMethod:l,contentURL:a,onClose:function(){var e=t+"_"+u.options.formid+"_"+c;try{n.blocks[e].destroyElements(),n.blocks[e].formElements=null,n.blocks[e]=null,delete n.blocks[e],n.fireEvent("details"===t?"fabrik.list.row.view.close":"fabrik.list.row.edit.close",[d,c,e])}catch(o){console.log(o)}}},u&&(""!==u.options.popup_width&&(f.width=u.options.popup_width),""!==u.options.popup_height&&(f.height=u.options.popup_height),f.id="details"===t?"view."+f.id:"add."+f.id,null!==u.options.popup_offset_x&&(f.offset_x=u.options.popup_offset_x),null!==u.options.popup_offset_y&&(f.offset_y=u.options.popup_offset_y)),n.getWindow(f)}},n.timePickerClose=function(t,o){if(t){var i=e(t).closest("form");if(i.length>0&&(i=n.getBlock(i[0].id))){var a=e(t).closest(".fabrikSubElementContainer");if(a.length>0){var l=i.formElements.get(a[0].id);l&&l.hideTime(t,o)}}}},n.Array={chunk:function(e,t){var o,i,n=[];for(o=0,i=e.length;o<i;o+=t)n.push(e.slice(o,o+t));return n}},window.fireEvent("fabrik.loaded"),window.Fabrik=n,n});
//# sourceMappingURL=fabrik.js.map