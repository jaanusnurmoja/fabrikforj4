/*! Fabrik */
define(["jquery"],function(t){return new Class({options:{imageover:"",imageout:"",userid:"",formid:0,noAccessMsg:"",canUse:!0},Implements:[Events,Options],initialize:function(t,s){this.setOptions(s),this.col=document.getElements("#list_"+this.options.renderContext+" ."+t),this.origThumbUp={},this.origThumbDown={},Fabrik.bootstrapped||this.options.j3?"comment"===this.options.voteType?this.setUpBootstrappedComments():this.setUpBootstrapped():this.col.each(function(t){var o,e,s=t.getParent(".fabrik_row");s&&(o=s.id.replace("list_"+this.options.renderContext+"_row_",""),e=t.getElements(".thumbup"),s=t.getElements(".thumbdown"),e.each(function(s){this.options.canUse?(s.addEvent("mouseover",function(t){s.setStyle("cursor","pointer"),s.src=this.options.imagepath+"thumb_up_in.gif"}.bind(this)),s.addEvent("mouseout",function(t){s.setStyle("cursor",""),"up"===this.options.myThumbs[o]?s.src=this.options.imagepath+"thumb_up_in.gif":s.src=this.options.imagepath+"thumb_up_out.gif"}.bind(this)),s.addEvent("click",function(t){this.doAjax(s,"up")}.bind(this))):s.addEvent("click",function(t){t.stop(),this.doNoAccess()}.bind(this))}.bind(this)),s.each(function(s){this.options.canUse?(s.addEvent("mouseover",function(t){s.setStyle("cursor","pointer"),s.src=this.options.imagepath+"thumb_down_in.gif"}.bind(this)),s.addEvent("mouseout",function(t){s.setStyle("cursor",""),"down"===this.options.myThumbs[o]?s.src=this.options.imagepath+"thumb_down_in.gif":s.src=this.options.imagepath+"thumb_down_out.gif"}.bind(this)),s.addEvent("click",function(t){this.doAjax(s,"down")}.bind(this))):e.addEvent("click",function(t){t.stop(),this.doNoAccess()}.bind(this))}.bind(this)))}.bind(this))},setUpBootstrappedComments:function(){document.addEvent("click:relay(*[data-fabrik-thumb])",function(t,s){var o,e,i,n;this.options.canUse?(o=!s.hasClass("btn-success"),n=s.get("data-fabrik-thumb"),e=s.get("data-fabrik-thumb-formid"),i=s.get("data-fabrik-thumb-rowid"),this.doAjax(s,n,o),"up"===n?o?(s.addClass("btn-success"),document.getElements("button[data-fabrik-thumb-formid="+e+"][data-fabrik-thumb-rowid="+i+"][data-fabrik-thumb=down]").removeClass("btn-danger")):s.removeClass("btn-success"):(n=document.getElements("button[data-fabrik-thumb-formid="+e+"][data-fabrik-thumb-rowid="+i+"][data-fabrik-thumb=up]"),o?(s.addClass("btn-danger"),n.removeClass("btn-success")):s.removeClass("btn-danger"))):(t.stop(),this.doNoAccess())}.bind(this))},setUpBootstrapped:function(){this.col.each(function(t){var s,o,e=t.getParent(".fabrik_row");e&&(e.id.replace("list_"+this.options.renderContext+"_row_",""),s=t.getElement("button.thumb-up"),o=t.getElement("button.thumb-down"),s.addEvent("click",function(t){t.stop(),this.options.canUse?(t=!s.hasClass("btn-success"),this.doAjax(s,"up",t),t?(s.addClass("btn-success"),"null"!==typeOf(o)&&o.removeClass("btn-danger")):s.removeClass("btn-success")):this.doNoAccess()}.bind(this)),"null"!==typeOf(o))&&o.addEvent("click",function(t){t.stop(),this.options.canUse?(t=!o.hasClass("btn-danger"),this.doAjax(o,"down",t),t?(o.addClass("btn-danger"),s.removeClass("btn-success")):o.removeClass("btn-danger")):this.doNoAccess()}.bind(this))}.bind(this))},doAjax:function(t,s,o){var e,i;this.options.canUse?(o=!!o,e=t.getParent(),i=t.get("data-fabrik-thumb-rowid"),document.id("count_thumb"+s+i),Fabrik.loader.start(e),this.thumb=s,t={option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"thumbs",method:"ajax_rate",g:"element",element_id:this.options.elid,row_id:i,elementname:this.options.elid,userid:this.options.userid,thumb:this.thumb,listid:this.options.listid,formid:this.options.formid,add:o},"comment"===this.options.voteType&&(t.special="comments_"+this.options.formid),new Request({url:"",data:t,onComplete:function(t){var s=document.id("count_thumbup"+i),o=document.id("count_thumbdown"+i);e.getElements(".thumbup"),e.getElements(".thumbdown");Fabrik.loader.stop(e),(t=JSON.parse(t)).error?console.log(t.error):Fabrik.bootstrapped?(e.getElement("button.thumb-up .thumb-count").set("text",t[0]),"null"!==typeOf(e.getElement("button.thumb-down"))&&e.getElement("button.thumb-down .thumb-count").set("text",t[1])):(s.set("html",t[0]),o.set("html",t[1]))}.bind(this)}).send()):this.doNoAccess()},doNoAccess:function(){""!==this.options.noAccessMsg&&window.alert(this.options.noAccessMsg)}})});
//# sourceMappingURL=list-thumbs-min.js.map