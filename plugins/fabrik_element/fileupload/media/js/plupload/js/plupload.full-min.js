/*! Fabrik */
!function(){var c,s,n=0,p=[],t={},e={},i={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},r=/[<>&\"\']/g,f=window.setTimeout,o={};function l(){this.returnValue=!1}function d(){this.cancelBubble=!0}for(var a,u,g="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats,docx pptx xlsx,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,text/csv,csv,text/plain,asc txt text diff log,application/octet-stream,exe".split(/,/),h=0;h<g.length;h+=2)for(u=g[h+1].split(/ /),a=0;a<u.length;a++)e[u[a]]=g[h];var m,v,b,E,y,_={VERSION:"1.5.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:e,ua:(m=navigator,v=m.userAgent,b=m.vendor,E=/WebKit/.test(v),b=E&&-1!==b.indexOf("Apple"),y=window.opera&&window.opera.buildNumber,{windows:-1!==navigator.platform.indexOf("Win"),ie:!E&&!y&&/MSIE/gi.test(v)&&/Explorer/gi.test(m.appName),webkit:E,gecko:!E&&/Gecko/.test(v),safari:b,opera:!!y}),extend:function(n){return _.each(arguments,function(e,t){0<t&&_.each(e,function(e,t){n[t]=e})}),n},cleanName:function(e){for(var t=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],n=0;n<t.length;n+=2)e=e.replace(t[n],t[n+1]);return e=(e=e.replace(/\s+/g,"_")).replace(/[^a-z0-9_\-\.]+/gi,"")},addRuntime:function(e,t){return t.name=e,p[e]=t,p.push(t),t},guid:function(){for(var e=(new Date).getTime().toString(32),t=0;t<5;t++)e+=Math.floor(65535*Math.random()).toString(32);return(_.guidPrefix||"p")+e+(n++).toString(32)},buildUrl:function(e,t){var n="";return _.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(0<e.indexOf("?")?"&":"?")+n),e},each:function(e,t){var n,i,r;if(e)if((n=e.length)===c){for(i in e)if(e.hasOwnProperty(i)&&!1===t(e[i],i))return}else for(r=0;r<n;r++)if(!1===t(e[r],r))return},formatSize:function(e){return e===c||/\D/.test(e)?_.translate("N/A"):1073741824<e?Math.round(e/1073741824,1)+" GB":1048576<e?Math.round(e/1048576,1)+" MB":1024<e?Math.round(e/1024,1)+" KB":e+" b"},getPos:function(e,t){var n,i,r,a=0,s=0,o=document;function l(e){var t,n=0,i=0;return e&&(e=e.getBoundingClientRect(),t="CSS1Compat"===o.compatMode?o.documentElement:o.body,n=e.left+t.scrollLeft,i=e.top+t.scrollTop),{x:n,y:i}}if(t=t||o.body,e&&e.getBoundingClientRect&&0<navigator.userAgent.indexOf("MSIE")&&8!==o.documentMode)return i=l(e),r=l(t),{x:i.x-r.x,y:i.y-r.y};for(n=e;n&&n!=t&&n.nodeType;)a+=n.offsetLeft||0,s+=n.offsetTop||0,n=n.offsetParent;for(n=e.parentNode;n&&n!=t&&n.nodeType;)a-=n.scrollLeft||0,s-=n.scrollTop||0,n=n.parentNode;return{x:a,y:s}},getSize:function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}},parseSize:function(e){var t;return"string"==typeof e&&(t=(e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")))[2],e=+e[1],"g"==t&&(e*=1073741824),"m"==t&&(e*=1048576),"k"==t)&&(e*=1024),e},xmlEncode:function(e){return e&&(""+e).replace(r,function(e){return i[e]?"&"+i[e]+";":e})},toArray:function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t},addI18n:function(e){return _.extend(t,e)},translate:function(e){return t[e]||e},isEmptyObj:function(e){if(e!==c)for(var t in e)return!1;return!0},hasClass:function(e,t){return""!=e.className&&new RegExp("(^|\\s+)"+t+"(\\s+|$)").test(e.className)},addClass:function(e,t){_.hasClass(e,t)||(e.className=""==e.className?t:e.className.replace(/\s+$/,"")+" "+t)},removeClass:function(e,t){t=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(t,function(e,t,n){return" "===t&&" "===n?" ":""})},getStyle:function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:void 0},addEvent:function(e,t,n){var i,r,a=arguments[3];t=t.toLowerCase(),s===c&&(s="Plupload_"+_.guid()),e.addEventListener?e.addEventListener(t,i=n,!1):e.attachEvent&&e.attachEvent("on"+t,i=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=l,e.stopPropagation=d,n(e)}),e[s]===c&&(e[s]=_.guid()),o.hasOwnProperty(e[s])||(o[e[s]]={}),(r=o[e[s]]).hasOwnProperty(t)||(r[t]=[]),r[t].push({func:i,orig:n,key:a})},removeEvent:function(t,e){var n,i;if("function"==typeof arguments[2]?n=arguments[2]:i=arguments[2],e=e.toLowerCase(),t[s]&&o[t[s]]&&o[t[s]][e]){for(var r,a=(r=o[t[s]][e]).length-1;0<=a&&(r[a].key!==i&&r[a].orig!==n||(t.detachEvent?t.detachEvent("on"+e,r[a].func):t.removeEventListener&&t.removeEventListener(e,r[a].func,!1),r[a].orig=null,r[a].func=null,r.splice(a,1),n===c));a--);if(r.length||delete o[t[s]][e],_.isEmptyObj(o[t[s]])){delete o[t[s]];try{delete t[s]}catch(e){t[s]=c}}}},removeAllEvents:function(n){var i=arguments[1];n[s]!==c&&n[s]&&_.each(o[n[s]],function(e,t){_.removeEvent(n,t,i)})}};_.Uploader=function(l){var n,i,r={},d=[];function u(){var e,t,n=0;if(this.state==_.STARTED){for(t=0;t<d.length;t++)e||d[t].status!=_.QUEUED?n++:((e=d[t]).status=_.UPLOADING,this.trigger("BeforeUpload",e)&&this.trigger("UploadFile",e));n==d.length&&(this.stop(),this.trigger("UploadComplete",d))}}function g(){var e,t;for(n.reset(),e=0;e<d.length;e++)(t=d[e]).size!==c?(n.size+=t.size,n.loaded+=t.loaded):n.size=c,t.status==_.DONE?n.uploaded++:t.status==_.FAILED?n.failed++:n.queued++;n.size===c?n.percent=0<d.length?Math.ceil(n.uploaded/d.length*100):0:(n.bytesPerSec=Math.ceil(n.loaded/((+new Date-i||1)/1e3)),n.percent=0<n.size?Math.ceil(n.loaded/n.size*100):0)}n=new _.QueueProgress,l=_.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},l),_.extend(this,{state:_.STOPPED,runtime:"",features:{},files:d,settings:l,total:n,id:_.guid(),init:function(){var t,a,e,o=this,s=0;if("function"==typeof l.preinit?l.preinit(o):_.each(l.preinit,function(e,t){o.bind(t,e)}),l.page_url=l.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/"),/^(\w+:\/\/|\/)/.test(l.url)||(l.url=l.page_url+l.url),l.chunk_size=_.parseSize(l.chunk_size),l.max_file_size=_.parseSize(l.max_file_size),o.bind("FilesAdded",function(e,t){var n,i,r,a=0,s=l.filters;for(s&&s.length&&(r=[],_.each(s,function(e){_.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?r.push("\\.*"):r.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),r=new RegExp(r.join("|")+"$","i")),n=0;n<t.length;n++)(i=t[n]).loaded=0,i.percent=0,i.status=_.QUEUED,r&&!r.test(i.name)?e.trigger("Error",{code:_.FILE_EXTENSION_ERROR,message:_.translate("File extension error."),file:i}):i.size!==c&&i.size>l.max_file_size?e.trigger("Error",{code:_.FILE_SIZE_ERROR,message:_.translate("File size error."),file:i}):(d.push(i),a++);if(!a)return!1;f(function(){o.trigger("QueueChanged"),o.refresh()},1)}),l.unique_names&&o.bind("UploadFile",function(e,t){var n=t.name.match(/\.([^.]+)$/),i="tmp";n&&(i=n[1]),t.target_name=t.id+"."+i}),o.bind("UploadProgress",function(e,t){t.percent=0<t.size?Math.ceil(t.loaded/t.size*100):100,g()}),o.bind("StateChanged",function(e){if(e.state==_.STARTED)i=+new Date;else if(e.state==_.STOPPED)for(t=e.files.length-1;0<=t;t--)e.files[t].status==_.UPLOADING&&(e.files[t].status=_.QUEUED,g())}),o.bind("QueueChanged",g),o.bind("Error",function(e,t){t.file&&(t.file.status=_.FAILED,g(),e.state==_.STARTED)&&f(function(){u.call(o)},1)}),o.bind("FileUploaded",function(e,t){t.status=_.DONE,t.loaded=t.size,e.trigger("UploadProgress",t),f(function(){u.call(o)},1)}),l.runtimes)for(a=[],e=l.runtimes.split(/\s?,\s?/),t=0;t<e.length;t++)p[e[t]]&&a.push(p[e[t]]);else a=p;!function t(){var n,e,i,r=a[s++];if(r){if(n=r.getFeatures(),e=o.settings.required_features)for(e=e.split(","),i=0;i<e.length;i++)if(!n[e[i]])return void t();r.init(o,function(e){e&&e.success?(o.features=n,o.runtime=r.name,o.trigger("Init",{runtime:r.name}),o.trigger("PostInit"),o.refresh()):t()})}else o.trigger("Error",{code:_.INIT_ERROR,message:_.translate("Init error.")})}(),"function"==typeof l.init?l.init(o):_.each(l.init,function(e,t){o.bind(t,e)})},refresh:function(){this.trigger("Refresh")},start:function(){this.state!=_.STARTED&&(this.state=_.STARTED,this.trigger("StateChanged"),u.call(this))},stop:function(){this.state!=_.STOPPED&&(this.state=_.STOPPED,this.trigger("StateChanged"))},getFile:function(e){for(var t=d.length-1;0<=t;t--)if(d[t].id===e)return d[t]},removeFile:function(e){for(var t=d.length-1;0<=t;t--)if(d[t].id===e.id)return this.splice(t,1)[0]},splice:function(e,t){e=d.splice(e===c?0:e,t===c?d.length:t);return this.trigger("FilesRemoved",e),this.trigger("QueueChanged"),e},trigger:function(e){var t,n,i=r[e.toLowerCase()];if(i)for((n=Array.prototype.slice.call(arguments))[0]=this,t=0;t<i.length;t++)if(!1===i[t].func.apply(i[t].scope,n))return!1;return!0},hasEventListener:function(e){return!!r[e.toLowerCase()]},bind:function(e,t,n){var i;e=e.toLowerCase(),(i=r[e]||[]).push({func:t,scope:n||this}),r[e]=i},unbind:function(e){e=e.toLowerCase();var t,n=r[e],i=arguments[1];if(n){if(i!==c){for(t=n.length-1;0<=t;t--)if(n[t].func===i){n.splice(t,1);break}}else n=[];n.length||delete r[e]}},unbindAll:function(){var n=this;_.each(r,function(e,t){n.unbind(t)})},destroy:function(){this.trigger("Destroy"),this.unbindAll()}})},_.File=function(e,t,n){var i=this;i.id=e,i.name=t,i.size=n,i.loaded=0,i.percent=0,i.status=0},_.Runtime=function(){this.getFeatures=function(){},this.init=function(e,t){}},_.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},_.runtimes={},window.plupload=_}(),function(){if(!window.google||!google.gears){var t=null;if("undefined"!=typeof GearsFactory)t=new GearsFactory;else try{-1!=(t=new ActiveXObject("Gears.Factory")).getBuildInfo().indexOf("ie_mobile")&&t.privateSetGlobalObject(this)}catch(e){void 0!==navigator.mimeTypes&&navigator.mimeTypes["application/x-googlegears"]&&((t=document.createElement("object")).style.display="none",t.width=0,t.height=0,t.type="application/x-googlegears",document.documentElement.appendChild(t))}t&&(window.google||(window.google={}),google.gears||(google.gears={factory:t}))}}(),function(e,r,v){var b={};v.runtimes.Gears=v.addRuntime("gears",{getFeatures:function(){return{dragdrop:!0,jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(s,t){var o;if(!e.google||!google.gears)return t({success:!1});try{o=google.gears.factory.create("beta.desktop")}catch(e){return t({success:!1})}function l(e){for(var t,n,i=[],r=0;r<e.length;r++)t=e[r],n=v.guid(),b[n]=t.blob,i.push(new v.File(n,t.name,t.blob.length));s.trigger("FilesAdded",i)}s.bind("PostInit",function(){var a=s.settings,e=r.getElementById(a.drop_element);e&&(v.addEvent(e,"dragover",function(e){o.setDropEffect(e,"copy"),e.preventDefault()},s.id),v.addEvent(e,"drop",function(e){var t=o.getDragData(e,"application/x-gears-files");t&&l(t.files),e.preventDefault()},s.id)),v.addEvent(r.getElementById(a.browse_button),"click",function(e){var t,n,i,r=[];e.preventDefault();e:for(t=0;t<a.filters.length;t++)for(i=a.filters[t].extensions.split(","),n=0;n<i.length;n++){if("*"===i[n]){r=[];break e}r.push("."+i[n])}o.openFiles(l,{singleFile:!a.multi_selection,filter:r})},s.id)}),s.bind("UploadFile",function(u,g){var c,p,f,h=0,m=0,e=u.settings.resize;e&&/\.(png|jpg|jpeg)$/i.test(g.name)&&(b[g.id]=function(e,t,n){var i,r=google.gears.factory.create("beta.canvas");try{if(r.decode(e),t.width||(t.width=r.width),t.height||(t.height=r.height),(i=Math.min(width/r.width,height/r.height))<1||1===i&&"image/jpeg"===n)return r.resize(Math.round(r.width*i),Math.round(r.height*i)),t.quality?r.encode(n,{quality:t.quality/100}):r.encode(n)}catch(e){}return e}(b[g.id],e,/\.png$/i.test(g.name)?"image/png":"image/jpeg")),g.size=b[g.id].length,p=u.settings.chunk_size,f=0<p,c=Math.ceil(g.size/p),f||(p=g.size,c=1),function t(){var n,i,r,a,s,e=u.settings.multipart,o=0,l={name:g.target_name||g.name},d=u.settings.url;g.status!=v.DONE&&g.status!=v.FAILED&&u.state!=v.STOPPED&&(f&&(l.chunk=h,l.chunks=c),i=Math.min(p,g.size-h*p),e||(d=v.buildUrl(u.settings.url,l)),(n=google.gears.factory.create("beta.httprequest")).open("POST",d),e||(n.setRequestHeader("Content-Disposition",'attachment; filename="'+g.name+'"'),n.setRequestHeader("Content-Type","application/octet-stream")),v.each(u.settings.headers,function(e,t){n.setRequestHeader(t,e)}),n.upload.onprogress=function(e){g.loaded=m+e.loaded-o,u.trigger("UploadProgress",g)},n.onreadystatechange=function(){var e;4==n.readyState&&(200==n.status?(e={chunk:h,chunks:c,response:n.responseText,status:n.status},u.trigger("ChunkUploaded",g,e),e.cancelled?g.status=v.FAILED:(m+=i,++h>=c?(g.status=v.DONE,u.trigger("FileUploaded",g,{response:n.responseText,status:n.status})):t())):u.trigger("Error",{code:v.HTTP_ERROR,message:v.translate("HTTP Error."),file:g,chunk:h,chunks:c,status:n.status}))},h<c)&&(d=b[g.id].slice(h*p,i),a="----pluploadboundary"+v.guid(),s="\r\n",e&&(n.setRequestHeader("Content-Type","multipart/form-data; boundary="+a),r=google.gears.factory.create("beta.blobbuilder"),v.each(v.extend(l,u.settings.multipart_params),function(e,t){r.append("--"+a+s+'Content-Disposition: form-data; name="'+t+'"'+s+s),r.append(e+s)}),e=v.mimeTypes[g.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",r.append("--"+a+s+'Content-Disposition: form-data; name="'+u.settings.file_data_name+'"; filename="'+g.name+'"'+s+"Content-Type: "+e+s+s),r.append(d),r.append(s+"--"+a+"--"+s),e=r.getAsBlob(),o=e.length-d.length,d=e),n.send(d))}()}),s.bind("Destroy",function(e){var t,n,i={browseButton:e.settings.browse_button,dropElm:e.settings.drop_element};for(t in i)(n=r.getElementById(i[t]))&&v.removeAllEvents(n,e.id)}),t({success:!0})}})}(window,document,plupload),function(a,u,g,c){var p={},f={};g.silverlight={trigger:function(e,t){var n,i=p[e];i&&((n=g.toArray(arguments).slice(1))[0]="Silverlight:"+t,setTimeout(function(){i.trigger.apply(i,n)},0))}},g.runtimes.Silverlight=g.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(o,e){var t,n,i="",r=o.settings.filters,l=u.body;if(!function(t){var n,i,r,a,s,o=!1,l=0;try{try{new ActiveXObject("AgControl.AgControl").IsVersionSupported(t)&&(o=!0),0}catch(e){var d=navigator.plugins["Silverlight Plug-In"];if(d){for(i=(n="1.0.30226.2"===(n=d.description)?"2.0.30226.2":n).split(".");3<i.length;)i.pop();for(;i.length<4;)i.push(0);for(r=t.split(".");4<r.length;)r.pop();for(;a=parseInt(r[l],10),s=parseInt(i[l],10),++l<r.length&&a===s;);a<=s&&!isNaN(a)&&(o=!0)}}}catch(e){o=!1}return o}("2.0.31005.0")||a.opera&&a.opera.buildNumber)e({success:!1});else{for(f[o.id]=!1,p[o.id]=o,(t=u.createElement("div")).id=o.id+"_silverlight_container",g.extend(t.style,{position:"absolute",top:"0px",background:o.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:o.settings.shim_bgcolor||8<u.documentMode?"":.01}),t.className="plupload silverlight",o.settings.container&&(l=u.getElementById(o.settings.container),"static"===g.getStyle(l,"position"))&&(l.style.position="relative"),l.appendChild(t),n=0;n<r.length;n++)i+=(""!=i?"|":"")+r[n].title+" | *."+r[n].extensions.replace(/,/g,";*.");t.innerHTML='<object id="'+o.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+o.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+o.id+",filter="+i+",multiselect="+o.settings.multi_selection+'"/></object>',o.bind("Silverlight:Init",function(){var a,s={};f[o.id]||(f[o.id]=!0,o.bind("Silverlight:StartSelectFiles",function(e){a=[]}),o.bind("Silverlight:SelectFile",function(e,t,n,i){var r=g.guid();s[r]=t,s[t]=r,a.push(new g.File(r,n,i))}),o.bind("Silverlight:SelectSuccessful",function(){a.length&&o.trigger("FilesAdded",a)}),o.bind("Silverlight:UploadChunkError",function(e,t,n,i,r){o.trigger("Error",{code:g.IO_ERROR,message:"IO Error.",details:r,file:e.getFile(s[t])})}),o.bind("Silverlight:UploadFileProgress",function(e,t,n,i){t=e.getFile(s[t]);t.status!=g.FAILED&&(t.size=i,t.loaded=n,e.trigger("UploadProgress",t))}),o.bind("Refresh",function(e){var t,n=u.getElementById(e.settings.browse_button);n&&(t=g.getPos(n,u.getElementById(e.settings.container)),n=g.getSize(n),g.extend(u.getElementById(e.id+"_silverlight_container").style,{top:t.y+"px",left:t.x+"px",width:n.w+"px",height:n.h+"px"}))}),o.bind("Silverlight:UploadChunkSuccessful",function(e,t,n,i,r){t=e.getFile(s[t]);e.trigger("ChunkUploaded",t,{chunk:n,chunks:i,response:r}),t.status!=g.FAILED&&d().UploadNextChunk(),n==i-1&&(t.status=g.DONE,e.trigger("FileUploaded",t,{response:r}))}),o.bind("Silverlight:UploadSuccessful",function(e,t,n){t=e.getFile(s[t]);t.status=g.DONE,e.trigger("FileUploaded",t,{response:n})}),o.bind("FilesRemoved",function(e,t){for(var n=0;n<t.length;n++)d().RemoveFile(s[t[n].id])}),o.bind("UploadFile",function(e,t){var n=e.settings,i=n.resize||{};d().UploadFile(s[t.id],e.settings.url,function e(t){var i,n,r,a=typeof t;if(t===c||null===t)return"null";if("string"==a)return i="\bb\tt\nn\ff\rr\"\"''\\\\",'"'+t.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(e,t){var n=i.indexOf(t);return n+1?"\\"+i.charAt(n+1):(e=t.charCodeAt().toString(16),"\\u"+"0000".substring(e.length)+e)})+'"';if("object"!=a)return""+t;if(a=t.length!==c,i="",a){for(n=0;n<t.length;n++)i&&(i+=","),i+=e(t[n]);i="["+i+"]"}else{for(r in t)t.hasOwnProperty(r)&&(i&&(i+=","),i+=e(r)+":"+e(t[r]));i="{"+i+"}"}return i}({name:t.target_name||t.name,mime:g.mimeTypes[t.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:n.chunk_size,image_width:i.width,image_height:i.height,image_quality:i.quality||90,multipart:!!n.multipart,multipart_params:n.multipart_params||{},file_data_name:n.file_data_name,headers:n.headers}))}),o.bind("Silverlight:MouseEnter",function(e){var t=u.getElementById(o.settings.browse_button),e=e.settings.browse_button_hover;t&&e&&g.addClass(t,e)}),o.bind("Silverlight:MouseLeave",function(e){var t=u.getElementById(o.settings.browse_button),e=e.settings.browse_button_hover;t&&e&&g.removeClass(t,e)}),o.bind("Silverlight:MouseLeftButtonDown",function(e){var t=u.getElementById(o.settings.browse_button),n=e.settings.browse_button_active;t&&n&&(g.addClass(t,n),g.addEvent(u.body,"mouseup",function(){g.removeClass(t,n)}))}),o.bind("Sliverlight:StartSelectFiles",function(e){var t=u.getElementById(o.settings.browse_button),e=e.settings.browse_button_active;t&&e&&g.removeClass(t,e)}),o.bind("Destroy",function(e){g.removeAllEvents(u.body,e.id),delete f[e.id],delete p[e.id],(e=u.getElementById(e.id+"_silverlight_container"))&&l.removeChild(e)}),e({success:!0}))})}function d(){return u.getElementById(o.id+"_silverlight").content.Upload}}})}(window,document,plupload),function(d,u){var g={},c={};u.flash={trigger:function(t,n,i){setTimeout(function(){var e=g[t];e&&e.trigger("Flash:"+n,i)},0)}},u.runtimes.Flash=u.addRuntime("flash",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,maxWidth:8091,maxHeight:8091,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(o,t){var e,n,i,r=0,a=d.body;function l(){return d.getElementById(o.id+"_flash")}(function(){var t;try{t=(t=navigator.plugins["Shockwave Flash"]).description}catch(e){try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){t="0.0"}}return t=t.match(/\d+/g),parseFloat(t[0]+"."+t[1])})()<10?t({success:!1}):(c[o.id]=!1,g[o.id]=o,d.getElementById(o.settings.browse_button),(e=d.createElement("div")).id=o.id+"_flash_container",u.extend(e.style,{position:"absolute",top:"0px",background:o.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"}),e.className="plupload flash",o.settings.container&&(a=d.getElementById(o.settings.container),"static"===u.getStyle(a,"position"))&&(a.style.position="relative"),a.appendChild(e),i='<object id="'+o.id+'_flash" type="application/x-shockwave-flash" data="'+o.settings.flash_swf_url+'" ',u.ua.ie&&(i+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),i+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+o.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(o.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',u.ua.ie?(n=d.createElement("div"),e.appendChild(n),n.outerHTML=i):e.innerHTML=i,function e(){5e3<r++?t({success:!1}):c[o.id]||setTimeout(e,1)}(),e=null,o.bind("Flash:Init",function(){var s={};l().setFileFilters(o.settings.filters,o.settings.multi_selection),c[o.id]||(c[o.id]=!0,o.bind("UploadFile",function(e,t){var e=e.settings,n=o.settings.resize||{};l().uploadFile(s[t.id],e.url,{name:t.target_name||t.name,mime:u.mimeTypes[t.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:e.chunk_size,width:n.width,height:n.height,quality:n.quality,multipart:e.multipart,multipart_params:e.multipart_params||{},file_data_name:e.file_data_name,format:/\.(jpg|jpeg)$/i.test(t.name)?"jpg":"png",headers:e.headers,urlstream_upload:e.urlstream_upload})}),o.bind("Flash:UploadProcess",function(e,t){var n=e.getFile(s[t.id]);n.status!=u.FAILED&&(n.loaded=t.loaded,n.size=t.size,e.trigger("UploadProgress",n))}),o.bind("Flash:UploadChunkComplete",function(e,t){var n=e.getFile(s[t.id]),i={chunk:t.chunk,chunks:t.chunks,response:t.text};e.trigger("ChunkUploaded",n,i),n.status!=u.FAILED&&l().uploadNextChunk(),t.chunk==t.chunks-1&&(n.status=u.DONE,e.trigger("FileUploaded",n,{response:t.text}))}),o.bind("Flash:SelectFiles",function(e,t){for(var n,i,r=[],a=0;a<t.length;a++)n=t[a],i=u.guid(),s[i]=n.id,s[n.id]=i,r.push(new u.File(i,n.name,n.size));r.length&&o.trigger("FilesAdded",r)}),o.bind("Flash:SecurityError",function(e,t){o.trigger("Error",{code:u.SECURITY_ERROR,message:u.translate("Security error."),details:t.message,file:o.getFile(s[t.id])})}),o.bind("Flash:GenericError",function(e,t){o.trigger("Error",{code:u.GENERIC_ERROR,message:u.translate("Generic error."),details:t.message,file:o.getFile(s[t.id])})}),o.bind("Flash:IOError",function(e,t){o.trigger("Error",{code:u.IO_ERROR,message:u.translate("IO error."),details:t.message,file:o.getFile(s[t.id])})}),o.bind("Flash:ImageError",function(e,t){o.trigger("Error",{code:parseInt(t.code,10),message:u.translate("Image error."),file:o.getFile(s[t.id])})}),o.bind("Flash:StageEvent:rollOver",function(e){var t=d.getElementById(o.settings.browse_button),e=e.settings.browse_button_hover;t&&e&&u.addClass(t,e)}),o.bind("Flash:StageEvent:rollOut",function(e){var t=d.getElementById(o.settings.browse_button),e=e.settings.browse_button_hover;t&&e&&u.removeClass(t,e)}),o.bind("Flash:StageEvent:mouseDown",function(e){var t=d.getElementById(o.settings.browse_button),n=e.settings.browse_button_active;t&&n&&(u.addClass(t,n),u.addEvent(d.body,"mouseup",function(){u.removeClass(t,n)},e.id))}),o.bind("Flash:StageEvent:mouseUp",function(e){var t=d.getElementById(o.settings.browse_button),e=e.settings.browse_button_active;t&&e&&u.removeClass(t,e)}),o.bind("Flash:ExifData",function(e,t){o.trigger("ExifData",o.getFile(s[t.id]),t.data)}),o.bind("Flash:GpsData",function(e,t){o.trigger("GpsData",o.getFile(s[t.id]),t.data)}),o.bind("QueueChanged",function(e){o.refresh()}),o.bind("FilesRemoved",function(e,t){for(var n=0;n<t.length;n++)l().removeFile(s[t[n].id])}),o.bind("StateChanged",function(e){o.refresh()}),o.bind("Refresh",function(e){var t,n;l().setFileFilters(o.settings.filters,o.settings.multi_selection),(n=d.getElementById(e.settings.browse_button))&&(t=u.getPos(n,d.getElementById(e.settings.container)),n=u.getSize(n),u.extend(d.getElementById(e.id+"_flash_container").style,{top:t.y+"px",left:t.x+"px",width:n.w+"px",height:n.h+"px"}))}),o.bind("Destroy",function(e){u.removeAllEvents(d.body,e.id),delete c[e.id],delete g[e.id],(e=d.getElementById(e.id+"_flash_container"))&&a.removeChild(e)}),t({success:!0}))}))}})}((window,document),plupload),function(p){p.runtimes.BrowserPlus=p.addRuntime("browserplus",{getFeatures:function(){return{dragdrop:!0,jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(a,n){var g=window.BrowserPlus,c={},s=a.settings,i=s.resize;function o(e){for(var t,n,i=[],r=0;r<e.length;r++)t=e[r],n=p.guid(),c[n]=t,i.push(new p.File(n,t.name,t.size));r&&a.trigger("FilesAdded",i)}function r(){a.bind("PostInit",function(){var e,i=s.drop_element,r=a.id+"_droptarget",t=document.getElementById(i);function n(t,n){g.DragAndDrop.AddDropTarget({id:t},function(e){g.DragAndDrop.AttachCallbacks({id:t,hover:function(e){!e&&n&&n()},drop:function(e){n&&n(),o(e)}},function(){})})}t&&(document.attachEvent&&/MSIE/gi.test(navigator.userAgent)?((e=document.createElement("div")).setAttribute("id",r),p.extend(e.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0}),document.body.appendChild(e),p.addEvent(t,"dragenter",function(e){var t=document.getElementById(i),n=p.getPos(t);p.extend(document.getElementById(r).style,{top:n.y+"px",left:n.x+"px",width:t.offsetWidth+"px",height:t.offsetHeight+"px"})}),n(r,function(){document.getElementById(r).style.top="-1000px"})):n(i)),p.addEvent(document.getElementById(s.browse_button),"click",function(e){var t,n,i,r=[],a=s.filters;e.preventDefault();e:for(t=0;t<a.length;t++)for(i=a[t].extensions.split(","),n=0;n<i.length;n++){if("*"===i[n]){r=[];break e}r.push(p.mimeTypes[i[n]])}g.FileBrowse.OpenBrowseDialog({mimeTypes:r},function(e){e.success&&o(e.value)})})}),a.bind("UploadFile",function(a,s){var o,e=c[s.id],t={},l=a.settings.chunk_size,d=[];function u(i,n){var r;s.status!=p.FAILED&&(t.name=s.target_name||s.name,l&&(t.chunk=""+i,t.chunks=""+n),r=d.shift(),g.Uploader.upload({url:a.settings.url,files:{file:r},cookies:document.cookies,postvars:p.extend(t,a.settings.multipart_params),progressCallback:function(e){var t,n=0;for(o[i]=parseInt(e.filePercent*r.size/100,10),t=0;t<o.length;t++)n+=o[t];s.loaded=n,a.trigger("UploadProgress",s)}},function(e){var t;e.success?(t=e.value.statusCode,l&&a.trigger("ChunkUploaded",s,{chunk:i,chunks:n,response:e.value.body,status:t}),0<d.length?u(++i,n):(s.status=p.DONE,a.trigger("FileUploaded",s,{response:e.value.body,status:t}),400<=t&&a.trigger("Error",{code:p.HTTP_ERROR,message:p.translate("HTTP Error."),file:s,status:t}))):a.trigger("Error",{code:p.GENERIC_ERROR,message:p.translate("Generic Error."),file:s,details:e.error})}))}function n(e){s.size=e.size,l?g.FileAccess.chunk({file:e,chunkSize:l},function(e){if(e.success){var t=e.value,n=t.length;o=Array(n);for(var i=0;i<n;i++)o[i]=0,d.push(t[i]);u(0,n)}}):(o=Array(1),d.push(e),u(0,1))}i&&/\.(png|jpg|jpeg)$/i.test(s.name)?BrowserPlus.ImageAlter.transform({file:e,quality:i.quality||90,actions:[{scale:{maxwidth:i.width,maxheight:i.height}}]},function(e){e.success&&n(e.value.file)}):n(e)}),n({success:!0})}g?g.init(function(e){var t=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];i&&t.push({service:"ImageAlter",version:"4"}),e.success?g.require({services:t},function(e){(e.success?r:n)()}):n()}):n()}})}(plupload),function(F,f,x,h){var s,m={};function o(a,s,o,l){var d,u,g,c,e,t,n,p=this;e=m[a.id],t=function(r){(d=f.createElement("canvas")).style.display="none",f.body.appendChild(d),u=d.getContext("2d"),(g=new Image).onerror=g.onabort=function(){l({success:!1})},g.onload=function(){var e,t,n,i;if(s.width||(s.width=g.width),s.height||(s.height=g.height),(c=Math.min(s.width/g.width,s.height/g.height))<1||1===c&&"image/jpeg"===o){if(e=Math.round(g.width*c),t=Math.round(g.height*c),d.width=e,d.height=t,u.drawImage(g,0,0,e,t),"image/jpeg"===o){if((n=new v(atob(r.substring(r.indexOf("base64,")+7)))).headers&&n.headers.length&&(i=new b).init(n.get("exif")[0])&&(i.setExif("PixelXDimension",e),i.setExif("PixelYDimension",t),n.set("exif",i.getBinary()),p.hasEventListener("ExifData")&&p.trigger("ExifData",a,i.EXIF()),p.hasEventListener("GpsData"))&&p.trigger("GpsData",a,i.GPS()),s.quality)try{r=d.toDataURL(o,s.quality/100)}catch(e){r=d.toDataURL(o)}}else r=d.toDataURL(o);r=r.substring(r.indexOf("base64,")+7),r=atob(r),n&&n.headers&&n.headers.length&&(r=n.restore(r),n.purge()),d.parentNode.removeChild(d),l({success:!0,data:r})}else l({success:!1})},g.src=r},"FileReader"in F?((n=new FileReader).readAsDataURL(e),n.onload=function(){t(n.result)}):t(e.getAsDataURL())}function l(){var a,o=!1;function l(e,t){for(var n=o?0:-8*(t-1),i=0,r=0;r<t;r++)i|=a.charCodeAt(e+r)<<Math.abs(n+8*r);return i}function d(e,t,n){n=3===arguments.length?n:a.length-t-1;a=a.substr(0,t)+e+a.substr(n+t)}return{II:function(e){if(e===h)return o;o=e},init:function(e){o=!1,a=e},SEGMENT:function(e,t,n){switch(arguments.length){case 1:return a.substr(e,a.length-e-1);case 2:return a.substr(e,t);case 3:d(n,e,t);break;default:return a}},BYTE:function(e){return l(e,1)},SHORT:function(e){return l(e,2)},LONG:function(e,t){if(t===h)return l(e,4);for(var n=t,i=4,r="",a=o?0:-8*(i-1),s=0;s<i;s++)r+=String.fromCharCode(n>>Math.abs(a+8*s)&255);d(r,e,i)},SLONG:function(e){e=l(e,4);return 2147483647<e?e-4294967296:e},STRING:function(e,t){var n="";for(t+=e;e<t;e++)n+=String.fromCharCode(l(e,1));return n}}}function v(e){var a,t,n,i,r={65505:{app:"EXIF",name:"APP1",signature:"Exif\0"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\0"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\0"}},s=[],o=new l;if(o.init(e),65496===o.SHORT(0)){for(a=2,i=Math.min(1048576,e.length);a<=i;)if(65488<=(t=o.SHORT(a))&&t<=65495)a+=2;else{if(65498===t||65497===t)break;n=o.SHORT(a+2)+2,r[t]&&o.STRING(a+4,r[t].signature.length)===r[t].signature&&s.push({hex:t,app:r[t].app.toUpperCase(),name:r[t].name.toUpperCase(),start:a,length:n,segment:o.SEGMENT(a,n)}),a+=n}return o.init(null),{headers:s,restore:function(e){o.init(e);var t=new v(e);if(!t.headers)return!1;for(var n=t.headers.length;0<n;n--){var i=t.headers[n-1];o.SEGMENT(i.start,i.length,"")}t.purge(),a=65504==o.SHORT(2)?4+o.SHORT(4):2;for(var n=0,r=s.length;n<r;n++)o.SEGMENT(a,0,s[n].segment),a+=s[n].length;return o.SEGMENT()},get:function(e){for(var t=[],n=0,i=s.length;n<i;n++)s[n].app===e.toUpperCase()&&t.push(s[n].segment);return t},set:function(e,t){var n=[];"string"==typeof t?n.push(t):n=t;for(var i=ii=0,r=s.length;i<r&&(s[i].app===e.toUpperCase()&&(s[i].segment=n[ii],s[i].length=n[ii].length,ii++),!(ii>=n.length));i++);},purge:function(){s=[],o.init(null)}}}}function b(){var g,u,c,p={};function t(e,t){for(var n,i,r,a,s,o=g.SHORT(e),l=[],d={},u=0;u<o;u++)if(a=e+12*u+2,(i=t[g.SHORT(a)])!==h){switch(s=g.SHORT(a+=2),r=g.LONG(a+=2),a+=4,l=[],s){case 1:case 7:for(4<r&&(a=g.LONG(a)+p.tiffHeader),n=0;n<r;n++)l[n]=g.BYTE(a+n);break;case 2:4<r&&(a=g.LONG(a)+p.tiffHeader),d[i]=g.STRING(a,r-1);continue;case 3:for(2<r&&(a=g.LONG(a)+p.tiffHeader),n=0;n<r;n++)l[n]=g.SHORT(a+2*n);break;case 4:for(1<r&&(a=g.LONG(a)+p.tiffHeader),n=0;n<r;n++)l[n]=g.LONG(a+4*n);break;case 5:for(a=g.LONG(a)+p.tiffHeader,n=0;n<r;n++)l[n]=g.LONG(a+4*n)/g.LONG(a+4*n+4);break;case 9:for(a=g.LONG(a)+p.tiffHeader,n=0;n<r;n++)l[n]=g.SLONG(a+4*n);break;case 10:for(a=g.LONG(a)+p.tiffHeader,n=0;n<r;n++)l[n]=g.SLONG(a+4*n)/g.SLONG(a+4*n+4);break;default:continue}s=1==r?l[0]:l,c.hasOwnProperty(i)&&"object"!=typeof s?d[i]=c[i][s]:d[i]=s}return d}return g=new l,u={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},c={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(e){return p={tiffHeader:10},!(e===h||!e.length||(g.init(e),65505!==g.SHORT(0))||"EXIF\0"!==g.STRING(4,5).toUpperCase()||(e=p.tiffHeader,g.II(18761==g.SHORT(e)),42!==g.SHORT(e+=2))||(p.IFD0=p.tiffHeader+g.LONG(e+=2),e=t(p.IFD0,u.tiff),p.exifIFD="ExifIFDPointer"in e?p.tiffHeader+e.ExifIFDPointer:h,p.gpsIFD="GPSInfoIFDPointer"in e?p.tiffHeader+e.GPSInfoIFDPointer:h,0))},EXIF:function(){var e=t(p.exifIFD,u.exif);return e.ExifVersion&&(e.ExifVersion=String.fromCharCode(e.ExifVersion[0],e.ExifVersion[1],e.ExifVersion[2],e.ExifVersion[3])),e},GPS:function(){var e=t(p.gpsIFD,u.gps);return e.GPSVersionID&&(e.GPSVersionID=e.GPSVersionID.join(".")),e},setExif:function(e,t){if("PixelXDimension"!==e&&"PixelYDimension"!==e)return!1;var n,r,a,s="exif",o=e,e=t,l=0;if("string"==typeof o){var d=u[s.toLowerCase()];for(hex in d)if(d[hex]===o){o=hex;break}}for(n=p[s.toLowerCase()+"IFD"],r=g.SHORT(n),i=0;i<r;i++)if(a=n+12*i+2,g.SHORT(a)==o){l=a+8;break}return!!l&&(g.LONG(l,e),!0)},getBinary:function(){return g.SEGMENT()}}}x.runtimes.Html5=x.addRuntime("html5",{getFeatures:function(){var e,t,n,i,r,a=e=n=i=!1;return F.XMLHttpRequest&&(e=!!(r=new XMLHttpRequest).upload,a=!(!r.sendAsBinary&&!r.upload)),a&&(t=!!(r.sendAsBinary||F.Uint8Array&&F.ArrayBuffer),n=!(!File||!File.prototype.getAsDataURL&&!F.FileReader||!t),i=!(!File||!(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice))),s=x.ua.safari&&x.ua.windows,{html5:a,dragdrop:"draggable"in(r=f.createElement("div"))||"ondragstart"in r&&"ondrop"in r,jpgresize:n,pngresize:n,multipart:n||!!F.FileReader||!!F.FormData,canSendBinary:t,cantSendBlobInFormData:!(!(x.ua.gecko&&F.FormData&&F.FileReader)||FileReader.prototype.readAsArrayBuffer),progress:e,chunks:i,multi_selection:!(x.ua.safari&&x.ua.windows),triggerDialog:x.ua.gecko&&F.FormData||x.ua.webkit}},init:function(c,e){var w;function p(e){for(var t,n,i=[],r={},a=0;a<e.length;a++)r[(t=e[a]).name]||(r[t.name]=!0,n=x.guid(),m[n]=t,i.push(new x.File(n,t.fileName||t.name,t.fileSize||t.size)));i.length&&c.trigger("FilesAdded",i)}(w=this.getFeatures()).html5?(c.bind("Init",function(t){var e,n,i,r,a,s,o,l=[],d=t.settings.filters,u=f.body,g=f.createElement("div");g.id=t.id+"_html5_container",x.extend(g.style,{position:"absolute",background:c.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:c.settings.shim_bgcolor?"":0}),g.className="plupload html5",c.settings.container&&(u=f.getElementById(c.settings.container),"static"===x.getStyle(u,"position"))&&(u.style.position="relative"),u.appendChild(g);e:for(n=0;n<d.length;n++)for(r=d[n].extensions.split(/,/),i=0;i<r.length;i++){if("*"===r[i]){l=[];break e}(a=x.mimeTypes[r[i]])&&l.push(a)}g.innerHTML='<input id="'+c.id+'_html5"  style="font-size:999px" type="file" accept="'+l.join(",")+'" '+(c.settings.multi_selection&&c.features.multi_selection?'multiple="multiple"':"")+" />",g.scrollTop=100,u=f.getElementById(c.id+"_html5"),t.features.triggerDialog?x.extend(u.style,{position:"absolute",width:"100%",height:"100%"}):x.extend(u.style,{cssFloat:"right",styleFloat:"right"}),u.onchange=function(){p(this.files),this.value=""},(e=f.getElementById(t.settings.browse_button))&&(s=t.settings.browse_button_hover,o=t.settings.browse_button_active,u=t.features.triggerDialog?e:g,s&&(x.addEvent(u,"mouseover",function(){x.addClass(e,s)},t.id),x.addEvent(u,"mouseout",function(){x.removeClass(e,s)},t.id)),o&&(x.addEvent(u,"mousedown",function(){x.addClass(e,o)},t.id),x.addEvent(f.body,"mouseup",function(){x.removeClass(e,o)},t.id)),t.features.triggerDialog)&&x.addEvent(e,"click",function(e){f.getElementById(t.id+"_html5").click(),e.preventDefault()},t.id)}),c.bind("PostInit",function(){var i=f.getElementById(c.settings.drop_element);i&&(s?x.addEvent(i,"dragenter",function(e){var t,n=f.getElementById(c.id+"_drop");n||((n=f.createElement("input")).setAttribute("type","file"),n.setAttribute("id",c.id+"_drop"),n.setAttribute("multiple","multiple"),x.addEvent(n,"change",function(){p(this.files),x.removeEvent(n,"change",c.id),n.parentNode.removeChild(n)},c.id),i.appendChild(n)),x.getPos(i,f.getElementById(c.settings.container)),t=x.getSize(i),"static"===x.getStyle(i,"position")&&x.extend(i.style,{position:"relative"}),x.extend(n.style,{position:"absolute",display:"block",top:0,left:0,width:t.w+"px",height:t.h+"px",opacity:0})},c.id):(x.addEvent(i,"dragover",function(e){e.preventDefault()},c.id),x.addEvent(i,"drop",function(e){var t=e.dataTransfer;t&&t.files&&p(t.files),e.preventDefault()},c.id)))}),c.bind("Refresh",function(e){var t,n,i=f.getElementById(c.settings.browse_button);i&&(e=x.getPos(i,f.getElementById(e.settings.container)),t=x.getSize(i),n=f.getElementById(c.id+"_html5_container"),x.extend(n.style,{top:e.y+"px",left:e.x+"px",width:t.w+"px",height:t.h+"px"}),c.features.triggerDialog)&&("static"===x.getStyle(i,"position")&&x.extend(i.style,{position:"relative"}),e=parseInt(x.getStyle(i,"z-index"),10),isNaN(e)&&(e=0),x.extend(i.style,{zIndex:e}),x.extend(n.style,{zIndex:e-1}))}),c.bind("UploadFile",function(y,_){var t,e,n,i,r=y.settings;function a(t){var b=0,E=0,n="FileReader"in F?new FileReader:null;!function u(){var g,c,p,f,h,m,v=y.settings.url;function e(n){var i,t=0,r=new XMLHttpRequest,e=r.upload,a="----pluploadboundary"+x.guid(),s="\r\n",o="";if(e&&(e.onprogress=function(e){_.loaded=Math.min(_.size,E+e.loaded-t),y.trigger("UploadProgress",_)}),r.onreadystatechange=function(){var t,e;if(4==r.readyState){try{t=r.status}catch(e){t=0}if(400<=t)y.trigger("Error",{code:x.HTTP_ERROR,message:x.translate("HTTP Error."),file:_,status:t});else{if(c){if(e={chunk:b,chunks:c,response:r.responseText,status:t},y.trigger("ChunkUploaded",_,e),E+=h,e.cancelled)return void(_.status=x.FAILED);_.loaded=Math.min(_.size,(b+1)*f)}else _.loaded=_.size;y.trigger("UploadProgress",_),n=g=i=o=null,!c||++b>=c?(_.status=x.DONE,y.trigger("FileUploaded",_,{response:r.responseText,status:t})):u()}r=null}},y.settings.multipart&&w.multipart){if(p.name=_.target_name||_.name,r.open("post",v,!0),x.each(y.settings.headers,function(e,t){r.setRequestHeader(t,e)}),"string"!=typeof n&&F.FormData)return i=new FormData,x.each(x.extend(p,y.settings.multipart_params),function(e,t){i.append(t,e)}),i.append(y.settings.file_data_name,n),void r.send(i);if("string"==typeof n){if(r.setRequestHeader("Content-Type","multipart/form-data; boundary="+a),x.each(x.extend(p,y.settings.multipart_params),function(e,t){o=(o+="--"+a+s+'Content-Disposition: form-data; name="'+t+'"'+s+s)+unescape(encodeURIComponent(e))+s}),m=x.mimeTypes[_.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",o+="--"+a+s+'Content-Disposition: form-data; name="'+y.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(_.name))+'"'+s+"Content-Type: "+m+s+s+n+s+"--"+a+"--"+s,t=o.length-n.length,n=o,r.sendAsBinary)r.sendAsBinary(n);else if(w.canSendBinary){for(var l=new Uint8Array(n.length),d=0;d<n.length;d++)l[d]=255&n.charCodeAt(d);r.send(l.buffer)}return}}v=x.buildUrl(y.settings.url,x.extend(p,y.settings.multipart_params)),r.open("post",v,!0),r.setRequestHeader("Content-Type","application/octet-stream"),x.each(y.settings.headers,function(e,t){r.setRequestHeader(t,e)}),r.send(n)}_.status!=x.DONE&&_.status!=x.FAILED&&y.state!=x.STOPPED&&(p={name:_.target_name||_.name},r.chunk_size&&_.size>r.chunk_size&&(w.chunks||"string"==typeof t)?(f=r.chunk_size,c=Math.ceil(_.size/f),h=Math.min(f,_.size-b*f),g="string"==typeof t?t.substring(b*f,b*f+h):function(t,n,i){var e;if(!File.prototype.slice)return(e=File.prototype.webkitSlice||File.prototype.mozSlice)?e.call(t,n,i):null;try{return t.slice(),t.slice(n,i)}catch(e){return t.slice(n,i-n)}}(t,b*f,b*f+h),p.chunk=b,p.chunks=c):(h=_.size,g=t),"string"!=typeof g&&n&&w.cantSendBlobInFormData&&w.chunks&&y.settings.chunk_size?(n.onload=function(){e(n.result)},n.readAsBinaryString(g)):e(g))}()}t=m[_.id],w.jpgresize&&y.settings.resize&&/\.(png|jpg|jpeg)$/i.test(_.name)?o.call(y,_,y.settings.resize,/\.png$/i.test(_.name)?"image/png":"image/jpeg",function(e){e.success?(_.size=e.data.length,a(e.data)):a(t)}):!w.chunks&&w.jpgresize?(e=t,n=a,"FileReader"in F?((i=new FileReader).readAsBinaryString(e),i.onload=function(){n(i.result)}):n(e.getAsBinary())):a(t)}),c.bind("Destroy",function(e){var t,n,i=f.body,r={inputContainer:e.id+"_html5_container",inputFile:e.id+"_html5",browseButton:e.settings.browse_button,dropElm:e.settings.drop_element};for(t in r)(n=f.getElementById(r[t]))&&x.removeAllEvents(n,e.id);x.removeAllEvents(f.body,e.id),(i=e.settings.container?f.getElementById(e.settings.container):i).removeChild(f.getElementById(r.inputContainer))}),e({success:!0})):e({success:!1})}})}(window,document,plupload),function(f,h,m){function v(e){return h.getElementById(e)}m.runtimes.Html4=m.addRuntime("html4",{getFeatures:function(){return{multipart:!0,triggerDialog:m.ua.gecko&&f.FormData||m.ua.webkit}},init:function(p,e){p.bind("Init",function(s){var n,r,o,e,t,i,a,l=h.body,d=[],u=/MSIE/.test(navigator.userAgent),g=[],c=s.settings.filters;e:for(e=0;e<c.length;e++)for(t=c[e].extensions.split(/,/),a=0;a<t.length;a++){if("*"===t[a]){g=[];break e}(i=m.mimeTypes[t[a]])&&g.push(i)}g=g.join(","),s.settings.container&&(l=v(s.settings.container),"static"===m.getStyle(l,"position"))&&(l.style.position="relative"),s.bind("UploadFile",function(e,t){var i;t.status!=m.DONE&&t.status!=m.FAILED&&e.state!=m.STOPPED&&(i=v("form_"+t.id),v("input_"+t.id).setAttribute("name",e.settings.file_data_name),i.setAttribute("action",e.settings.url),m.each(m.extend({name:t.target_name||t.name},e.settings.multipart_params),function(e,t){var n=h.createElement("input");m.extend(n,{type:"hidden",name:t,value:e}),i.insertBefore(n,i.firstChild)}),r=t,v("form_"+o).style.top="-1048575px",i.submit(),i.parentNode.removeChild(i))}),s.bind("FileUploaded",function(e){e.refresh()}),s.bind("StateChanged",function(e){var t;e.state==m.STARTED&&((t=h.createElement("div")).innerHTML='<iframe id="'+s.id+'_iframe" name="'+s.id+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',n=t.firstChild,l.appendChild(n),m.addEvent(n,"load",function(e){var t,e=e.target;if(r){try{t=e.contentWindow.document||e.contentDocument||f.frames[e.id].document}catch(e){return void s.trigger("Error",{code:m.SECURITY_ERROR,message:m.translate("Security error."),file:r})}(e=t.body.innerHTML)&&(r.status=m.DONE,r.loaded=1025,r.percent=100,s.trigger("UploadProgress",r),s.trigger("FileUploaded",r,{response:e}))}},s.id)),e.state==m.STOPPED&&f.setTimeout(function(){m.removeEvent(n,"load",e.id),n.parentNode&&n.parentNode.removeChild(n)},0)}),s.bind("Refresh",function(e){var t,n,i,r,a,s=v(e.settings.browse_button);s&&(a=m.getPos(s,v(e.settings.container)),i=m.getSize(s),r=v("form_"+o),v("input_"+o),m.extend(r.style,{top:a.y+"px",left:a.x+"px",width:i.w+"px",height:i.h+"px"}),e.features.triggerDialog&&("static"===m.getStyle(s,"position")&&m.extend(s.style,{position:"relative"}),a=parseInt(s.style.zIndex,10),isNaN(a)&&(a=0),m.extend(s.style,{zIndex:a}),m.extend(r.style,{zIndex:a-1})),t=e.settings.browse_button_hover,n=e.settings.browse_button_active,i=e.features.triggerDialog?s:r,t&&(m.addEvent(i,"mouseover",function(){m.addClass(s,t)},e.id),m.addEvent(i,"mouseout",function(){m.removeClass(s,t)},e.id)),n)&&(m.addEvent(i,"mousedown",function(){m.addClass(s,n)},e.id),m.addEvent(h.body,"mouseup",function(){m.removeClass(s,n)},e.id))}),p.bind("FilesRemoved",function(e,t){for(var n,i=0;i<t.length;i++)(n=v("form_"+t[i].id))&&n.parentNode.removeChild(n)}),p.bind("Destroy",function(e){var t,n,i,r={inputContainer:"form_"+o,inputFile:"input_"+o,browseButton:e.settings.browse_button};for(t in r)(n=v(r[t]))&&m.removeAllEvents(n,e.id);m.removeAllEvents(h.body,e.id),m.each(d,function(e,t){(i=v("form_"+e))&&l.removeChild(i)})}),function n(){var i,r,e,a;o=m.guid(),d.push(o),(i=h.createElement("form")).setAttribute("id","form_"+o),i.setAttribute("method","post"),i.setAttribute("enctype","multipart/form-data"),i.setAttribute("encoding","multipart/form-data"),i.setAttribute("target",s.id+"_iframe"),i.style.position="absolute",(r=h.createElement("input")).setAttribute("id","input_"+o),r.setAttribute("type","file"),r.setAttribute("accept",g),r.setAttribute("size",1),a=v(s.settings.browse_button),s.features.triggerDialog&&a&&m.addEvent(v(s.settings.browse_button),"click",function(e){r.click(),e.preventDefault()},s.id),m.extend(r.style,{width:"100%",height:"100%",opacity:0,fontSize:"999px"}),m.extend(i.style,{overflow:"hidden"}),(e=s.settings.shim_bgcolor)&&(i.style.background=e),u&&m.extend(r.style,{filter:"alpha(opacity=0)"}),m.addEvent(r,"change",function(e){var e=e.target,t=[];e.value&&(v("form_"+o).style.top="-1048575px",e=(e=e.value.replace(/\\/g,"/")).substring(e.length,e.lastIndexOf("/")+1),t.push(new m.File(o,e)),s.features.triggerDialog?m.removeEvent(a,"click",s.id):m.removeAllEvents(i,s.id),m.removeEvent(r,"change",s.id),n(),t.length)&&p.trigger("FilesAdded",t)},s.id),i.appendChild(r),l.appendChild(i),s.refresh()}()}),e({success:!0})}})}(window,document,plupload);